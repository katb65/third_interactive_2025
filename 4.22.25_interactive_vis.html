<meta charset="utf-8">
<!-- Basic security -->
<meta http-equiv="Content-Security-Policy" content="script-src 'self' https://d3js.org; style-src 'self'"> 

<!-- TODO add disabled to every input to start -->
<head>
    <!-- Load d3.js -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <!-- CSS -->
    <link rel="stylesheet" href="4.22.25_interactive_vis.css">
    <!-- Adjust mobile display -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>
    <div class = "header">
        <p id = "error-message" class = "titles"> Error present: see console to debug. </p>
        <div id = "state-select">
            <label class = "subtitles" for="state-select-drop">State:
            <select name="state-select-drop" id="state-select-drop" class = "regular-text" disabled></select></label>
        </div>
        <div id = "year-select">
            <label class = "subtitles" for="year-select-drop">Year:
            <select name="year-select-drop" id="year-select-drop" class = "regular-text" disabled></select></label>
        </div>
        <br/>
        <details>
            <summary class = "subtitles" > Advanced Variables: </summary>
            <fieldset>
                <div id = "GWh-or-GW">
                    <label for="GWH-or-GW-drop" class = "subtitles" >Units:
                    <select name = "GWh-or-GW-drop" id = "GWh-or-GW-drop" class = "regular-text" disabled>
                        <option value = "GWh" selected>GWh</option>
                        <option value = "GW">GW</option>
                    </select></label>
                </div>
                <br/>
                <div id = "green-select">
                    <text class = "subtitles" > Is It Green? </text>
                    <ul>
                    <li> 
                        <input type = "checkbox" class = "nuclear" value = "nuclear" id = "green-nuclear-checkbox" checked disabled></input>
                        <label for = "green-nuclear-checkbox" class = "regular-text" > Nuclear </label>
                    </li>
                    <li> 
                        <input type = "checkbox" class = "hydroelectric" id = "green-hydroelectric-checkbox" value = "hydroelectric" checked disabled></input>
                        <label for = "green-hydroelectric-checkbox" class = "regular-text" > Hydroelectric </label>
                    </li>
                    </ul>
                </div>
                <div id = "exclude-transportation-select">
                    <text class = "subtitles"> Exclude From Transportation's Electrification? </text>
                    <!-- TODO should residual also be excluded from the other sectors where it's used, or only transportation (ships) -->
                    <ul>
                        <li>
                            <input type = "checkbox" class = "aviation" id = "exclude-aviation-checkbox" value = "aviation" disabled></input>
                            <label for = "exclude-aviation-checkbox" class = "regular-text" > Aviation (Jet Fuel & Aviation Gasoline) </label>
                        </li>
                        <li>
                            <input type = "checkbox" class = "marine" id = "exclude-marine-checkbox" value = "marine" disabled></input>
                            <label for = "exclude-marine-checkbox" class = "regular-text" > Marine (Residual Fuel Oil) </label>
                        </li>
                    </ul>
                </div>
                <div id = "show-efficiencies">
                    <input type = "checkbox" class = "show-efficiencies" id = "show-efficiencies-checkbox" disabled></input>
                    <label for = "show-efficiencies-checkbox" class = "subtitles" > Show Efficiencies? </label>
                </div>
            </fieldset>
        </details>
        <br/>
        <details>
            <summary class = "regular-text" > Clarifications & Credits: </summary>
            <fieldset>
                <ul>
                    <li class = "regular-text"> 
                        <strong>Electric efficiency </strong> defines how much less electricity is needed to accomplish the same task as primary energy: 
                        the lower the factor (out of 1), the more efficient electricity is than primary energy. This is preset based on approximate values. 
                        <strong>Transmission efficiency</strong> is how much of the generated and imported energy makes it to be consumed by the sectors. 
                        This is calculated directly from the pulled data, and thus sometimes ends up over 1 (ex. some years of Hawaii), likely due to minor 
                        incongruencies in recording & rounding methods across the available datasets. Both can be changed after enabling their visibility in advanced settings.
                    </li>
                    <li class = "regular-text"> 
                        <strong>Electrification %</strong> is based on % of total raw energy in GWh, while <strong>demand %</strong> is based on "amount of users", 
                        each for some sector; this means the electric efficiency factor will impact them differently. For example, for a very low electric efficiency 
                        factor, the electrification % and total energy use may be <strong>low</strong> at the same time as the demand % is <strong>high</strong>, 
                        since this means a lot of users in that sector can get their needed energy supplied by an efficiently low amount (and thus also low proportion 
                        to total, including primary, energy) of electricity.
                    </li>
                    <li class = "regular-text"> 
                        Electrification sliders max out to leave all <strong>green primaries unelectrified</strong>; as well as transportation's aviation & marine 
                        sections, if chosen in advanced settings. If the slider is slid past this max, it resets back down to it.
                    </li>
                    <li class = "regular-text">
                        Available <strong> CO2 data is limited</strong>, splitting only into coal, natural gas, and petroleum. If aviation & marine details are 
                        selected in advanced settings, these are carved out as part of petroleum, and function at the same emission factor, though this is likely
                        inexact. Also for this reason, import & other are not adjustable as electricity sources - they produce CO2, but it can't be shown.
                    </li>
                    <li class = "regular-text"> 
                        Available <strong>years</strong> are calculated directly from the intersection of available datasets.
                    </li>
                    <li class = "regular-text"> 
                        Refer to <a href = https://www.nrel.gov/gis/solar-supply-curves.html class = "regular-text green-text"> NREL data </a> for real solar & 
                        wind capacities per state.
                    </li>
                    <!-- TODO mention wind & solar capacity -->
                </ul>
                <br/>
                <a href = https://d3js.org class = "mini-text green-text"> D3 </a><br/>
                <a href = https://www.eia.gov/opendata/browser/seds class = "mini-text green-text"> EIA Energy Data </a><br/>
                <a href = https://www.eia.gov/electricity/data/browser/ class = "mini-text green-text"> EIA Electricity Generation Data </a><br/>
                <a href = https://www.eia.gov/opendata/browser/co2-emissions class = "mini-text green-text"> EIA CO2 Data </a><br/>
                <a href = https://www.eia.gov/energyexplained/us-energy-facts/images/consumption-by-source-and-sector.pdf class = "mini-text green-text">
                    EIA Electric vs. Primary Energy Consumption
                </a><br/>
                <a href = https://www.eia.gov/tools/glossary/index.php class = "mini-text green-text">
                    EIA Glossary
                </a>
                <text class = "mini-text">
                    (ex. search "Primary Energy Consumption")
                </text><br/>
                <a href = https://uw.pressbooks.pub/climatejusticeandenergysolutions/chapter/electrification-is-cool/ class = "mini-text green-text">
                    Dargan Frierson Electric Efficiency Factors
                </a><br/>
            </fieldset>
        </details>
    </div>
    <div class="container">
        <div class="energy">
            <p class = "titles"> Energy </p>
            <div class ="grid">
                <div class="cell sector-industrial">
                    <text class = "subtitles"> Industrial </text>
                    <div class = "vis-container">
                        <svg class = "vis"></svg>
                    </div>
                    <br/>
                    <div class="input-container type-elec-efficiency" >
                        <text class = "regular-text"> Electric Efficiency: </text><br/>
                        <text class = "regular-text"> 0 </text>
                        <input class = "slider" type="range" min="0" max = "1" step="any" disabled></input>
                        <text class = "regular-text"> 1 </text>
                        <text class = "regular-text slider-output"> </text>
                    </div>
                    <div class="input-container type-demand">
                        <!-- TODO add text input box for precision? will need to filter out non numeric input + trigger slider event -->
                        <!-- TODO blurbs saying demand % inc's efffactor (by amt of things using it) whereas electrification % doesn't (by GWh)-->
                        <text class = "regular-text"> Demand: </text><br/>
                        <text class = "regular-text"> 0% </text>
                        <input  class = "slider" type="range" min = "0" max = "500" value = "100" step = "1" disabled></input>
                        <text class = "regular-text"> 500% </text>
                        <text class = "regular-text slider-output"> </text>
                    </div>
                    <div class="input-container type-electrification">
                        <text class = "regular-text"> Electrification: </text><br/>
                        <text class = "regular-text"> 0% </text>
                        <input class = "slider"  type="range" min = "0" max = "100" value = "0" step = "1" disabled></input>
                        <text class = "regular-text"> 100% </text>
                        <text class = "regular-text slider-output"> </text>
                    </div>
                </div>
                <div class="cell sector-transportation">
                    <text class = "subtitles"> Transportation </text>
                    <div class = "vis-container">
                        <svg class = "vis"></svg>
                    </div>
                    <br/>
                    <div class="input-container type-elec-efficiency">
                        <text class = "regular-text"> Electric Efficiency: </text><br/>
                        <text class = "regular-text"> 0 </text>
                        <input class = "slider" type="range" min="0" max = "1" step="any" disabled></input>
                        <text class = "regular-text"> 1 </text>
                        <text class = "regular-text slider-output"> </text>
                    </div>
                    <div class="input-container type-demand">
                        <text class = "regular-text"> Demand: </text><br/>
                        <text class = "regular-text"> 0% </text>
                        <input class = "slider"  type="range" min = "0" max = "500" value = "100" step = "1" disabled></input>
                        <text class = "regular-text"> 500% </text>
                        <text class = "regular-text slider-output"> </text>
                    </div>
                    <div class="input-container type-electrification">
                        <text class = "regular-text"> Electrification: </text><br/>
                        <text class = "regular-text"> 0% </text>
                        <input class = "slider" type="range" min = "0" max = "100" value = "0" step = "1" disabled></input>
                        <text class = "regular-text"> 100% </text>
                        <text class = "regular-text slider-output"> </text>
                    </div>
                </div>
                <div class="cell sector-commercial">
                    <text class = "subtitles"> Commercial </text>
                    <div class = "vis-container">
                        <svg class = "vis"></svg>
                    </div>
                    <br/>
                    <div class="input-container type-elec-efficiency">
                        <text class = "regular-text"> Electric Efficiency: </text><br/>
                        <text class = "regular-text"> 0 </text>
                        <input class = "slider" type="range" min="0" max = "1" step="any" disabled></input>
                        <text class = "regular-text"> 1 </text>
                        <text class = "regular-text slider-output"> </text>
                    </div>
                    <div class="input-container type-demand">
                        <text class = "regular-text"> Demand: </text><br/>
                        <text class = "regular-text"> 0% </text>
                        <input class = "slider" type="range" min = "0" max = "500" value = "100" step = "1" disabled></input>
                        <text class = "regular-text"> 500% </text>
                        <text class = "regular-text slider-output"> </text>
                    </div>
                    <div class="input-container type-electrification">
                        <text class = "regular-text"> Electrification: </text><br/>
                        <text class = "regular-text"> 0% </text>
                        <input class = "slider" type="range" min = "0" max = "100" value = "0" step = "1" disabled></input>
                        <text class = "regular-text"> 100% </text>
                        <text class = "regular-text slider-output"> </text>
                    </div>
                </div>
                <div class="cell sector-residential">
                    <text class = "subtitles"> Residential </text>
                    <div class = "vis-container">
                        <svg class = "vis"></svg>
                    </div>
                    <br/>
                    <div class="input-container type-elec-efficiency">
                        <text class = "regular-text"> Electric Efficiency: </text><br/>
                        <text class = "regular-text"> 0 </text>
                        <input class = "slider" type="range" min="0" max = "1" step="any" disabled></input>
                        <text class = "regular-text"> 1 </text>
                        <text class = "regular-text slider-output"> </text>
                    </div>
                    <div class="input-container type-demand">
                        <text class = "regular-text"> Demand: </text><br/>
                        <text class = "regular-text"> 0% </text>
                        <input class = "slider" type="range" min = "0" max = "500" value = "100" step = "1" disabled></input>
                        <text class = "regular-text"> 500% </text>
                        <text class = "regular-text slider-output"> </text>
                    </div>
                    <div class="input-container type-electrification">
                        <text class = "regular-text"> Electrification: </text><br/>
                        <text class = "regular-text"> 0% </text>
                        <input class = "slider" type="range" min = "0" max = "100" value = "0" step = "1" disabled></input>
                        <text class = "regular-text"> 100% </text>
                        <text class = "regular-text slider-output"> </text>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class = "container">
        <div class="electricity">
            <p class = "generation-output titles"> Electricity </p>
            <div class = "input-container type-equalize-demand">
                <p class = "demand-output subtitles"></p>
                <button type = "button" class = "button subtitles" disabled> Equalize Demand </button>
            </div>
            <div class = "column">
                <div class="input-container type-transmission-efficiency">
                    <p class = "regular-text"> Transmission Efficiency: </p>
                    <p class = "regular-text"> 0 </p>
                    <input class = "slider" type="range" min = "0" max = "1" value = "0" step = "any" disabled></input>
                    <p class = "regular-text"> 1 </p>
                    <p class = "regular-text slider-output"> </p>
                </div>
                <br/><br/>
                <text class="mini-text green-text"> (as % of initial total generation & import) </text>
                <div class="input-container type-piece-wind">
                    <p class = "regular-text"> Wind: </p>
                    <p class = "regular-text"> 0 </p>
                    <input class = "slider" type="range" min = "0" max = "500" value = "0" step = "1" disabled></input>
                    <p class = "regular-text"> 500% </p>
                    <p class = "regular-text slider-output"> </p>
                </div>
                <div class="input-container type-piece-solar">
                    <p class = "regular-text"> Solar: </p>
                    <p class = "regular-text"> 0 </p>
                    <input class = "slider" type="range" min = "0" max = "500" value = "0" step = "1" disabled></input>
                    <p class = "regular-text"> 500% </p>
                    <p class = "regular-text slider-output"> </p>
                </div>
                <div class="input-container type-piece-geothermal">
                    <p class = "regular-text"> Geothermal: </p>
                    <p class = "regular-text"> 0 </p>
                    <input class = "slider" type="range" min = "0" max = "500" value = "0" step = "1" disabled></input>
                    <p class = "regular-text"> 500% </p>
                    <p class = "regular-text slider-output"> </p>
                </div>
                <div class="input-container type-piece-hydroelectric">
                    <p class = "regular-text"> Hydroelectric: </p>
                    <p class = "regular-text"> 0 </p>
                    <input class = "slider" type="range" min = "0" max = "500" value = "0" step = "1" disabled></input>
                    <p class = "regular-text"> 500% </p>
                    <p class = "regular-text slider-output"> </p>
                </div>
                <div class="input-container type-piece-nuclear">
                    <p class = "regular-text"> Nuclear: </p>
                    <p class = "regular-text"> 0 </p>
                    <input class = "slider" type="range" min = "0" max = "500" value = "0" step = "1" disabled></input>
                    <p class = "regular-text"> 500% </p>
                    <p class = "regular-text slider-output"> </p>
                </div>
                <div class="input-container type-piece-coal">
                    <p class = "regular-text"> Coal: </p>
                    <p class = "regular-text"> 0 </p>
                    <input class = "slider" type="range" min = "0" max = "500" value = "0" step = "1" disabled></input>
                    <p class = "regular-text"> 500% </p>
                    <p class = "regular-text slider-output"> </p>
                </div>
                <div class="input-container type-piece-natural-gas">
                    <p class = "regular-text"> Natural Gas: </p>
                    <p class = "regular-text"> 0 </p>
                    <input class = "slider" type="range" min = "0" max = "500" value = "0" step = "1" disabled></input>
                    <p class = "regular-text"> 500% </p>
                    <p class = "regular-text slider-output"> </p>
                </div>
                <div class="input-container type-piece-petroleum">
                    <p class = "regular-text"> Petroleum: </p>
                    <p class = "regular-text"> 0 </p>
                    <input class = "slider" type="range" min = "0" max = "500" value = "0" step = "1" disabled></input>
                    <p class = "regular-text"> 500% </p>
                    <p class = "regular-text slider-output"> </p>
                </div>
                <br/>
                <div class="output-container type-piece-other">
                    <p class = "mini-text green-text"> Other: </p>
                    <p class = "mini-text green-text output"> </p>
                </div>
                <div class="output-container type-piece-import">
                    <p class = "mini-text green-text"> Import: </p>
                    <p class = "mini-text green-text output"> </p>
                </div>
            </div>
            <div class = "vis-container">
                <svg class = "vis"></svg>
            </div>
        </div>
    </div>
    <div class="container">
        <div class = "co2">
            <p class = "titles"> CO2 </p>
            <div class = "vis-container">
                <svg class = "vis"></svg>
            </div>
        </div>
    </div>
    <br/>
    <div class = "container">
        <div class = "legend">
            <p class = "titles"> Green: </p>
            <div class = "vis-container green"></div>
            <p class = "titles"> Not Green: </p>
            <div class = "vis-container ngreen"></div>
        </div>
    </div>
    <div class = "tooltip">
        <text class = "subtitles"></text> <br/>
        <br/>
        <text class = "regular-text line-1"></text> <br/>
        <text class = "regular-text line-2"></text> <br/>
    </div>

    <script src="4.22.25_interactive_vis.js"></script>
</body>